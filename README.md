# VM & Interpreter in C

A bytecode virtual machine and interpreter for the own programming language, written in C. This implementation is largely based on the Part III of the book **Crafting Interpreters** by Robert Nystrom.

**Project status:** Work in progress: core scanner, compiler, debugger and VM are implemented and can execute simple programs.

---

## Table of Contents
- [Features](#features)
- [Repository Structure](#repository-structure)
- [Prerequisites](#prerequisites)
- [Build](#build)
- [Usage](#usage)
- [Development notes](#development-notes)
- [Prerequisites](#prerequisites)

---

## Features
- Scanning: tokenizes source code into Lox tokens
- Compiling: Pratt parser and bytecode generator
- Virtual Machine: stack-based VM that executes compiled chunks
- REPL: interactive Read-Eval-Print Loop with line editing/history
- Basic arithmetic, control flow, variables, and functions (as implemented in the repo)

---

## Repository Structure
Key files and directories (top-level):

- `main.c` — program entry & CLI
- `scanner.c`, `scanner.h` — tokenizer for Lox source
- `compiler.c`, `compiler.h` — parser + bytecode compiler
- `vm.c`, `vm.h` — virtual machine executing bytecode
- `object.c`, `object.h` — runtime objects and value handling
- `memory.c`, `memory.h` — memory management helpers
- `debug.c`, `debug.h` — disassembly and debugging helpers
- `chunk.c`, `chunk.h` — bytecode chunk representation
- `table.c`, `table.h` — hash table implementation for globals
- `value.c`, `value.h` — value representation and utilities
- `Makefile` — build targets
- `build/` — build artifacts (generated)

> Tip: See inline comments in the `.c/.h` files for details about implementation and interfaces.

## Prerequisites
- A C compiler (gcc/clang)
- make
- Readline development library (for REPL history/editing)

On Debian/Ubuntu/WSL:

```bash
sudo apt update
sudo apt install build-essential libreadline-dev
```

On macOS (with Homebrew):

```bash
brew install readline
# you may need to set CPPFLAGS/LDFLAGS so the compiler finds readline headers and libs
```

---

## Build
From the project root run:

```bash
make
```

This builds the `clox` executable (or similar binary in the project root). To do a clean rebuild:

```bash
make clean && make
```

---

## Usage
Run the REPL:

```bash
./clox
```

Execute a Lox source file:

```bash
./clox path/to/script.lox
```

Example Lox snippet to try in the REPL:

```lox
print 1 + 2 * (3 - 4);
```

---

## Development notes
- The compiler emits bytecode into `Chunk` structures (`chunk.c/h`) which the VM (`vm.c/h`) then executes.
- `debug.c` contains a `disassemble` helper useful to inspect generated bytecode during development.
- Follow the structure from *Crafting Interpreters* if you plan to add language features — the code is organized by the same components (scanner → parser/compiler → VM).

---
## Prerequisites
To build `clox`, you need a C compiler, `make`, and the GNU Readline library.

### Linux (Ubuntu/WSL)
```bash
sudo apt-get update
sudo apt-get install build-essential libreadline-dev
